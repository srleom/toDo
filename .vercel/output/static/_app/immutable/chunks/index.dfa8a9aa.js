import{a as Pe,b as Ne,c as Ze}from"./navigation.fbf40b4d.js";import{p as re}from"./stores.a095dd00.js";import{k as qe,j as ee,w as Z}from"./singletons.5f32a592.js";import{l as g,j as ve,t as je}from"./scheduler.e04b059d.js";import{U as Oe,N as Be,P as We,a as Je,b as Ce,H as Ye,p as Ie}from"./parse.7d180a0f.js";const Ge=!0;class de extends Error{constructor(t,n){super(t),this.name="DevalueError",this.path=n.join("")}}function Ae(e){return Object(e)!==e}const Ke=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xe(e){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===Ke}function Qe(e){return Object.prototype.toString.call(e).slice(8,-1)}function ze(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function Q(e){let t="",n=0;const o=e.length;for(let s=0;s<o;s+=1){const i=e[s],r=ze(i);r&&(t+=e.slice(n,s)+r,n=s+1)}return`"${n===0?e:t+e.slice(n)}"`}function xe(e,t){const n=[],o=new Map,s=[];for(const f in t)s.push({key:f,fn:t[f]});const i=[];let r=0;function u(f){if(typeof f=="function")throw new de("Cannot stringify a function",i);if(o.has(f))return o.get(f);if(f===void 0)return Oe;if(Number.isNaN(f))return Be;if(f===1/0)return We;if(f===-1/0)return Je;if(f===0&&1/f<0)return Ce;const v=r++;o.set(f,v);for(const{key:l,fn:b}of s){const p=b(f);if(p)return n[v]=`["${l}",${u(p)}]`,v}let m="";if(Ae(f))m=me(f);else switch(Qe(f)){case"Number":case"String":case"Boolean":m=`["Object",${me(f)}]`;break;case"BigInt":m=`["BigInt",${f}]`;break;case"Date":m=`["Date","${f.toISOString()}"]`;break;case"RegExp":const{source:b,flags:p}=f;m=p?`["RegExp",${Q(b)},"${p}"]`:`["RegExp",${Q(b)}]`;break;case"Array":m="[";for(let h=0;h<f.length;h+=1)h>0&&(m+=","),h in f?(i.push(`[${h}]`),m+=u(f[h]),i.pop()):m+=Ye;m+="]";break;case"Set":m='["Set"';for(const h of f)m+=`,${u(h)}`;m+="]";break;case"Map":m='["Map"';for(const[h,T]of f)i.push(`.get(${Ae(h)?me(h):"..."})`),m+=`,${u(h)},${u(T)}`;m+="]";break;default:if(!Xe(f))throw new de("Cannot stringify arbitrary non-POJOs",i);if(Object.getOwnPropertySymbols(f).length>0)throw new de("Cannot stringify POJOs with symbolic keys",i);if(Object.getPrototypeOf(f)===null){m='["null"';for(const h in f)i.push(`.${h}`),m+=`,${Q(h)},${u(f[h])}`,i.pop();m+="]"}else{m="{";let h=!1;for(const T in f)h&&(m+=","),h=!0,i.push(`.${T}`),m+=`${Q(T)}:${u(f[T])}`,i.pop();m+="}"}}return n[v]=m,v}const c=u(e);return c<0?`${c}`:`[${n.join(",")}]`}function me(e){const t=typeof e;return t==="string"?Q(e):e instanceof String?Q(e.toString()):e===void 0?Oe.toString():e===0&&1/e<0?Ce.toString():t==="bigint"?`["BigInt","${e}"]`:String(e)}const Ve=Ge;function se(e){return qe.apply_action(e)}function et(e){const t=JSON.parse(e);return t.data&&(t.data=Ie(t.data)),t}function ke(e){return HTMLElement.prototype.cloneNode.call(e)}function tt(e,t=()=>{}){const n=async({action:s,result:i,reset:r})=>{i.type==="success"&&(r!==!1&&HTMLFormElement.prototype.reset.call(e),await Pe()),(location.origin+location.pathname===s.origin+s.pathname||i.type==="redirect"||i.type==="error")&&se(i)};async function o(s){var p,h,T,S;if(((p=s.submitter)!=null&&p.hasAttribute("formmethod")?s.submitter.formMethod:ke(e).method)!=="post")return;s.preventDefault();const r=new URL((h=s.submitter)!=null&&h.hasAttribute("formaction")?s.submitter.formAction:ke(e).action),u=new FormData(e),c=(T=s.submitter)==null?void 0:T.getAttribute("name");c&&u.append(c,((S=s.submitter)==null?void 0:S.getAttribute("value"))??"");const f=new AbortController;let v=!1;const l=await t({action:r,cancel:()=>v=!0,controller:f,get data(){return u},formData:u,get form(){return e},formElement:e,submitter:s.submitter})??n;if(v)return;let b;try{const O=await fetch(r,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:u,signal:f.signal});b=et(await O.text()),b.type==="error"&&(b.status=O.status)}catch(O){if((O==null?void 0:O.name)==="AbortError")return;b={type:"error",error:O}}l({action:r,get data(){return u},formData:u,get form(){return e},formElement:e,update:O=>n({action:r,result:b,reset:O==null?void 0:O.reset}),result:b})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",o),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",o)}}}function oe(e){return e.toString().split(/[[\].]+/).filter(t=>t)}function pe(e){return e.reduce((t,n)=>(typeof n=="number"||!isNaN(parseInt(String(n),10))?t+=`[${String(n)}]`:t?t+=`.${String(n)}`:t+=String(n),t),"")}class L extends Error{constructor(t){super(t),Object.setPrototypeOf(this,L.prototype)}}function ue(e,t,n){return e[t]=n,"skip"}function we(e,t){return t.value!==void 0&&typeof t.value!="object"&&t.path.length<e.length}function rt(e,t,n={}){n.modifier||(n.modifier=s=>we(t,s)?void 0:s.value);const o=R(e,t,n.modifier);if(o)return n.value===void 0||n.value(o.value)?o:void 0}function R(e,t,n){if(!t.length)return;const o=[t[0]];let s=e;for(;o.length<t.length;){const r=o[o.length-1],u=n?n({parent:s,key:String(r),value:s[r],path:o.map(c=>String(c)),isLeaf:!1,set:c=>ue(s,r,c)}):s[r];if(u===void 0)return;s=u,o.push(t[o.length])}const i=t[t.length-1];return{parent:s,key:String(i),value:s[i],path:t.map(r=>String(r)),isLeaf:!0,set:r=>ue(s,i,r)}}function B(e,t,n=[]){for(const o in e){const s=e[o],i=s===null||typeof s!="object",r={parent:e,key:o,value:s,path:n.map(String).concat([o]),isLeaf:i,set:c=>ue(e,o,c)},u=t(r);if(u==="abort")return u;if(u==="skip")continue;if(!i){const c=B(s,t,r.path);if(c==="abort")return c}}}async function nt(e,t,n=[]){for(const o in e){const s=e[o],i=s===null||typeof s!="object",r={parent:e,key:o,value:s,path:n.map(String).concat([o]),isLeaf:i,set:c=>ue(e,o,c)},u=await t(r);if(u==="abort")return u;if(u==="skip")break;if(!i){const c=B(s,t,r.path);if(c==="abort")return c}}}function at(e,t){return e===t||e.size===t.size&&[...e].every(n=>t.has(n))}function it(e,t){const n=new Map;function o(s,i){const r=R(i,s.path);function u(){n.set(s.path.join(" "),s.path)}s.isLeaf?r?s.value!==r.value&&u():u():r&&(s.value instanceof Date&&r.value instanceof Date&&s.value.getTime()!=r.value.getTime()||s.value instanceof Set&&r.value instanceof Set&&!at(s.value,r.value))&&u()}return B(e,s=>o(s,t)),B(t,s=>o(s,e)),Array.from(n.values())}function G(e,t,n){for(const o of t){const s=R(e,o,({parent:i,key:r,value:u})=>((u===void 0||typeof u!="object")&&(i[r]={}),i[r]));s&&(s.parent[s.key]=n)}}function ye(e,t){const n=oe(t),o=ee(e,s=>{const i=R(s,n);return i==null?void 0:i.value});return{subscribe(...s){const i=o.subscribe(...s);return()=>{i()}},update(s){e.update(i=>{const r=R(i,n);return r&&(r.parent[r.key]=s(r.value)),i})},set(s){e.update(i=>{const r=R(i,n);return r&&(r.parent[r.key]=s),i})}}}function Y(e){return"structuredClone"in globalThis?structuredClone(e):Ie(xe(e))}function st(e){const t=e;let n=!0,o=!1,s=!1,i=!1,r,u;for(;n;)e._def.typeName=="ZodNullable"?(o=!0,e=e.unwrap()):e._def.typeName=="ZodDefault"?(i=!0,u=e._def.defaultValue(),e=e._def.innerType):e._def.typeName=="ZodOptional"?(s=!0,e=e.unwrap()):e._def.typeName=="ZodEffects"?(r||(r=e),e=e._def.schema):e._def.typeName=="ZodPipeline"?e=e._def.out:n=!1;return{zodType:e,originalType:t,isNullable:o,isOptional:s,hasDefault:i,defaultValue:u,effects:r}}const be=new WeakMap;function ge(e){return be.has(e)||be.set(e,te(e)),be.get(e)}function te(e){const t=st(e).zodType;if(t._def.typeName=="ZodObject")return Object.fromEntries(Object.entries(t.shape).map(([n,o])=>[n,te(o)]).filter(n=>n[1]!==void 0));if(t._def.typeName=="ZodArray")return te(t._def.type)??{};if(t._def.typeName=="ZodRecord")return te(t._def.valueType)??{};if(t._def.typeName=="ZodUnion")return t._def.options.reduce((o,s)=>{const i=te(s);return i&&(o={...o??{},...i}),o},void 0)}function fe(e,t,n=!0){const o={},s=Object.entries(e);if("_errors"in e&&e._errors.length){if(!t||!n)return e._errors;o._errors=e._errors}for(const[i,r]of s.filter(([u])=>u!=="_errors")){const u=!isNaN(parseInt(i,10));o[i]=fe(r,t?u?t:t[i]:void 0,!!(t!=null&&t[i]))}return o}function ot(e){return Re(e,[])}function Re(e,t){return Object.entries(e).filter(([,o])=>o!==void 0).flatMap(([o,s])=>{if(Array.isArray(s)&&s.length>0){const i=t.concat([o]);return{path:pe(i),messages:s}}else return Re(e[o],t.concat([o]))})}function Ee(e,t){e.update(n=>(B(n,o=>{if(!(o.path.length==1&&o.path[0]=="_errors"&&!t.clearFormLevelErrors)&&Array.isArray(o.value))return o.set(void 0)}),t.undefinePath&&G(n,[t.undefinePath],void 0),n))}async function $e(e,t,n,o,s){return ut(e.validators,t,n,o,s)}async function ut(e,t,n,o,s){let i=!0,r={};if(e)if("safeParseAsync"in e){const u=e,c=await u.safeParseAsync(t);i=c.success,c.success||(r=fe(c.error.format(),ge(u)))}else{t={...t};for(const[f,v]of Object.entries(e))typeof v=="function"&&!(f in t)&&(t[f]=void 0);const u=e,c=[];await nt(t,async({value:f,path:v})=>{const m=v.filter(b=>isNaN(parseInt(b))),l=R(u,m);if(typeof(l==null?void 0:l.value)=="function"){const b=l.value;let p;if(Array.isArray(f))for(const h in f)try{p=await b(f[h]),p&&(i=!1,c.push({path:v.concat([h]),errors:typeof p=="string"?[p]:p??void 0}))}catch(T){i=!1,console.error(`Error in form validators for field "${v}":`,T)}else try{p=await b(f),p&&(i=!1,c.push({path:v,errors:typeof p=="string"?[p]:p??void 0}))}catch(h){i=!1,console.error(`Error in form validators for field "${v}":`,h)}}});for(const{path:f,errors:v}of c){const m=R(r,f,({parent:l,key:b,value:p})=>(p===void 0&&(l[b]={}),l[b]));if(m){const{parent:l,key:b}=m;l[b]=v}}}return{valid:i,posted:s,errors:r,data:t,constraints:o,message:void 0,id:n}}async function ft(e,t,n,o){if(typeof e.validators!="object"||!("safeParseAsync"in e.validators))return;const s=e.validators,i=await s.safeParseAsync(t);if(i.success)n.update(r=>(B(r,u=>{if(u.key=="_errors")return u.set(void 0)}),r));else{const r=fe(i.error.format(),ge(s));n.update(u=>(B(u,c=>{if(c.key=="_errors")return c.set(void 0)}),B(r,c=>{if(c.key=="_errors"){const f=c.path.length==1?{value:!0}:o&&R(o,c.path.slice(0,-1));if(f&&f.value)return G(u,[c.path],c.value)}}),u))}}async function he(e,t,n,o,s,i={}){function r(){Ee(o,{undefinePath:e,clearFormLevelErrors:!0})}function u(f){return typeof f=="string"&&(f=[f]),(i.update===!0||i.update=="errors")&&o.update(v=>{const m=R(v,e,l=>{if(we(e,l))throw new L("Errors can only be added to form fields, not to arrays or objects in the schema. Path: "+l.path.slice(0,-1));return l.value===void 0?(l.parent[l.key]={},l.parent[l.key]):l.value});if(!m)throw new L("Error path could not be created: "+e);return m.parent[m.key]=f??void 0,v}),f??void 0}const c=await ct(e,t.validators,n,o,s,i);if(c.validated)if(c.validated==="all"&&!c.errors)r();else return u(c.errors);else if(c.validated===!1&&t.defaultValidator=="clear")return u(void 0);return c.errors}async function ct(e,t,n,o,s,i={}){i.update===void 0&&(i.update=!0),i.taint===void 0&&(i.taint=!1),typeof i.errors=="string"&&(i.errors=[i.errors]);const r={value:i.value,shouldUpdate:!0,currentData:void 0,validationPath:e.filter(l=>isNaN(parseInt(l)))};async function u(){return{validated:!1,errors:void 0}}function c(l,b){if(b===void 0)return!1;const p=R(b,l);return p?p.value:!1}function f(l){o.update(l)}function v(){Ee(o,{undefinePath:null,clearFormLevelErrors:!0})}function m(l,b){return fe(l.format(),ge(b))}if("value"in i)i.update===!0||i.update==="value"?n.update(l=>(G(l,[e],r.value),r.currentData=l),{taint:i.taint}):r.shouldUpdate=!1;else{r.currentData=g(n);const l=R(r.currentData,e);r.value=l==null?void 0:l.value}if(typeof t!="object")return u();if("safeParseAsync"in t){r.shouldUpdate||(r.currentData=Y(r.currentData??g(n)),G(r.currentData,[e],r.value));const l=await t.safeParseAsync(r.currentData);if(l.success)return v(),{validated:!0,errors:void 0};{const b=m(l.error,t);if(i.update===!0||i.update=="errors"){const h=g(s);f(T=>(B(T,S=>{if(S.key=="_errors")return S.set(void 0)}),B(b,S=>{if(S.key=="_errors"&&(S.path.length==1||c(S.path.slice(0,-1),h)))return G(T,[S.path],S.value);if(Array.isArray(S.value))return c(S.path,h)&&G(T,[S.path],S.value),"skip"}),T))}const p=R(b,e);return{validated:!0,errors:i.errors??(p==null?void 0:p.value)}}}else{const l=R(t,r.validationPath);if(!l||l.value===void 0)return u();{const b=await l.value(r.value);return{validated:!0,errors:b&&(i.errors??b)}}}}const lt=(e,t=0)=>{const n=e.getBoundingClientRect();return n.top>=t&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)},dt=(e,t=1.125,n="smooth")=>{const i=e.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*t);window.scrollTo({left:0,top:i,behavior:n})};var V;(function(e){e[e.Idle=0]="Idle",e[e.Submitting=1]="Submitting",e[e.Delayed=2]="Delayed",e[e.Timeout=3]="Timeout"})(V||(V={}));const mt=new Set;let Fe=!1;function yt(e,t,n){let o=V.Idle,s,i,r=!1;const u=mt;function c(){f(),m(o!=V.Delayed?V.Submitting:V.Delayed),s=window.setTimeout(()=>{s&&o==V.Submitting&&m(V.Delayed)},n.delayMs),i=window.setTimeout(()=>{i&&o==V.Delayed&&m(V.Timeout)},n.timeoutMs),u.add(f)}function f(){clearTimeout(s),clearTimeout(i),s=i=0,u.delete(f),m(V.Idle)}function v(){u.forEach(E=>E()),u.clear()}function m(E){o=E,t.submitting.set(o>=V.Submitting),t.delayed.set(o>=V.Delayed),t.timeout.set(o>=V.Timeout)}const l=e;function b(E){const M=E.target;n.selectErrorText&&M.select()}function p(){n.selectErrorText&&l.querySelectorAll("input").forEach(E=>{E.addEventListener("invalid",b)})}function h(){n.selectErrorText&&l.querySelectorAll("input").forEach(E=>E.removeEventListener("invalid",b))}const T=e;function S(E){return typeof n.autoFocusOnError=="boolean"?n.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(E)}const O=async()=>{if(n.scrollToError=="off")return;const E=n.errorSelector;if(!E)return;await je();let M;if(M=T.querySelector(E),!M)return;M=M.querySelector(E)??M;const H=n.stickyNavbar?document.querySelector(n.stickyNavbar):null;if(typeof n.scrollToError!="string"?M.scrollIntoView(n.scrollToError):lt(M,(H==null?void 0:H.offsetHeight)??0)||dt(M,void 0,n.scrollToError),!S(navigator.userAgent))return;let C;if(C=M,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(C.tagName)||(C=C.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),C)try{C.focus({preventScroll:!0}),n.selectErrorText&&C.tagName=="INPUT"&&C.select()}catch{}};{p();const E=(M,H=!1)=>{f(),M||setTimeout(O),H&&!r&&v()};return ve(()=>{h(),E(!0)}),Fe||(Ne(()=>{r=!0}),Ze(M=>{M.type!="enter"&&(r=!1,v())}),Fe=!0),{submitting:()=>{r=!1,c()},completed:E,scrollToFirstError:()=>{setTimeout(O)},isSubmitting:()=>o===V.Submitting||o===V.Delayed}}}function Me(e){!e.flashMessage||!Ve||_e(e)&&(document.cookie=`flash=; Max-Age=0; Path=${e.flashMessage.cookiePath??"/"};`)}function _e(e){return!e.flashMessage||!Ve?!1:e.syncFlashMessage}const Le="noCustomValidity";function Ue(e,t){const n=t&&t.length?t.join(`
`):"";e.setCustomValidity(n),n&&e.reportValidity()}function bt(e,t){for(const n of e.querySelectorAll("input,select,textarea,button")){if(Le in n.dataset)continue;const o=R(t,oe(n.name));if(Ue(n,o==null?void 0:o.value),o!=null&&o.value)return}}function pt(e,t,n,o,s,i,r,u,c,f,v,m,l,b,p,h,T){f();const S=s;async function O(A,P,k){if(r.validationMethod=="submit-only")return;if(r.customValidity&&k){if("setCustomValidity"in k&&k.setCustomValidity(""),P=="input"&&r.validationMethod=="onblur")return;if(Le in k.dataset){if(P=="input")return;k=null}}const I=await he(A,r,u,S,b);k&&Ue(k,I)}function E(A){return A&&(A instanceof HTMLSelectElement||A instanceof HTMLInputElement&&(A.type=="radio"||A.type=="checkbox"))}async function M(A){if(!(r.validationMethod=="oninput"||r.validationMethod=="submit-only")){E(A.target)&&await new Promise(P=>setTimeout(P,0));for(const P of g(p)){let k=null;if(r.customValidity){const I=CSS.escape(pe(P));k=e.querySelector(`[name="${I}"]`)}O(P,"blur",k)}p.set([])}}e.addEventListener("focusout",M);async function H(A){if(!(r.validationMethod=="onblur"||r.validationMethod=="submit-only")){E(A.target)&&await new Promise(P=>setTimeout(P,0));for(const P of g(p)){const k=CSS.escape(pe(P)),I=e.querySelector(`[name="${k}"]`);if(!I)continue;const x=R(g(S),P);x&&x.key in x.parent&&setTimeout(()=>O(P,"input",I),0)}}}r.customValidity&&e.addEventListener("input",H),ve(()=>{e.removeEventListener("focusout",M),e.removeEventListener("input",H)});const C=yt(e,{submitting:t,delayed:n,timeout:o},r);let J;return tt(e,async A=>{var ne;const P=A.cancel;let k=!1;function I(){return k=!0,P()}if(A.cancel=I,C.isSubmitting()&&r.multipleSubmits=="prevent")I();else{C.isSubmitting()&&r.multipleSubmits=="abort"&&J&&J.abort(),J=A.controller;for(const U of v.onSubmit)await U(A)}if(k)r.flashMessage&&Me(r);else{const U=await $e(r,g(u),g(m),g(l),g(T));if(!U.valid){I();const w={type:"failure",status:(typeof r.SPA=="boolean"||(ne=r.SPA)==null?void 0:ne.failStatus)??400,data:{form:U}};setTimeout(()=>$({result:w}),0)}if(!k){switch(r.clearOnSubmit){case"errors-and-message":S.clear(),c.set(void 0);break;case"errors":S.clear();break;case"message":c.set(void 0);break}r.flashMessage&&(r.clearOnSubmit=="errors-and-message"||r.clearOnSubmit=="message")&&_e(r)&&r.flashMessage.module.getFlash(re).set(void 0),C.submitting();const w="formData"in A?A.formData:A.data;if(r.SPA){I();const q={type:"success",status:200,data:{form:{valid:!0,posted:!0,errors:{},data:g(u),constraints:g(l),message:void 0,id:g(m)}}};setTimeout(()=>$({result:q}),0)}else if(r.dataType==="json"){const N=g(u),q=x(xe(N),r.jsonChunkSize??5e5);for(const j of q)w.append("__superform_json",j);Object.keys(N).forEach(j=>{typeof w.get(j)=="string"&&w.delete(j)})}if(!r.SPA&&!w.has("__superform_id")){const N=g(m);N!==void 0&&w.set("__superform_id",N)}}}function x(U,w){const N=Math.ceil(U.length/w),q=new Array(N);for(let j=0,D=0;j<N;++j,D+=w)q[j]=U.substring(D,D+w);return q}async function $(U){const w=U.result;J=null;let N=!1;const q={result:w,formEl:e,cancel:()=>N=!0};for(const j of v.onResult)await j(q);if(!N){if((w.type==="success"||w.type=="failure")&&w.data){const j=h(w.data);if(!j.length)throw new L("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const D of j){if(D.id!==g(m))continue;const z={form:D,formEl:e,cancel:()=>N=!0};for(const ce of v.onUpdate)await ce(z);!N&&r.customValidity&&bt(e,z.form.errors)}}if(!N){if(w.type!=="error")w.type==="success"&&r.invalidateAll&&await Pe(),r.applyAction?await se(w):await i(w);else{if(r.applyAction)if(r.onError=="apply")await se(w);else{const j={type:"failure",status:Math.floor(w.status||500),data:w};await se(j)}if(r.onError!=="apply"){const j={result:w,message:c};for(const D of v.onError)D!=="apply"&&await D(j)}}r.flashMessage&&w.type=="error"&&r.flashMessage.onError&&await r.flashMessage.onError({result:w,message:r.flashMessage.module.getFlash(re)})}}N&&r.flashMessage&&Me(r),N||w.type!="redirect"?C.completed(N):w.type=="redirect"&&new URL(w.location,/^https?:\/\//.test(w.location)?void 0:document.location.origin).pathname==document.location.pathname&&setTimeout(()=>{C.completed(!0,!0)},0)}return $})}new TextEncoder;const ht={applyAction:!0,invalidateAll:!0,resetForm:!1,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:'[aria-invalid="true"],[data-invalid]',selectErrorText:!1,stickyNavbar:void 0,taintedMessage:"Do you want to leave this page? Changes you made may not be saved.",onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:e=>{console.warn("Unhandled Superform error, use onError event to handle it:",e.result.error)},dataType:"form",validators:void 0,defaultValidator:"keep",customValidity:!1,clearOnSubmit:"errors-and-message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",validation:void 0,SPA:void 0,validateMethod:"auto"},ie=new WeakMap,X=new WeakMap;function vt(e){return`Duplicate form id's found: "${e}". Multiple forms will receive the same data. Use the id option to differentiate between them, or if this is intended, set the warnings.duplicateId option to false in superForm to disable this warning. More information: https://superforms.rocks/concepts/multiple-forms`}function Tt(e,t={}){var Se,Te;t={...ht,...t},t.SPA&&t.validators===void 0&&console.warn("No validators set for superForm in SPA mode. Add them to the validators option, or set it to false to disable this warning.");let n=t.id;!e||b(e)===!1?(((Se=t.warnings)==null?void 0:Se.noValidationAndConstraints)!==!1&&console.warn((e?"Form data sent directly to superForm instead of through superValidate. No initial data validation is made. ":"No form data sent to superForm, schema type safety cannot be guaranteed. ")+"Also, no constraints will exist for the form. Set the warnings.noValidationAndConstraints option to false to disable this warning."),e={valid:!1,posted:!1,errors:{},data:e??{},constraints:{}}):n===void 0&&(n=e.id);const o=n,s=g(re);if(((Te=t.warnings)==null?void 0:Te.duplicateId)!==!1)if(!ie.has(s))ie.set(s,new Set([o]));else{const a=ie.get(s);a!=null&&a.has(o)?console.warn(vt(o)):a==null||a.add(o)}X.has(e)||X.set(e,Y(e));const i=X.get(e);if(typeof i.valid!="boolean")throw new L("A non-validation object was passed to superForm. It should be an object of type SuperValidated, usually returned from superValidate.");s.form,e=Y(i);const r=e,u=Z(r.errors),c=Z(n),f={taintedMessage:t.taintedMessage,taintedFormState:Y(i.data)};function v(a=8){return Math.random().toString(36).substring(2,a+2)}function m(a){f.taintedFormState=Y(a)}function l(a){return Object.values(a).filter(y=>b(y)!==!1)}function b(a){return!a||typeof a!="object"||!("valid"in a&&"errors"in a&&typeof a.valid=="boolean")?!1:"id"in a&&typeof a.id=="string"?a.id:void 0}function p(){t.taintedMessage=f.taintedMessage,n===void 0&&c.set(v())}function h(a){const d=Z(a);return{subscribe:d.subscribe,set:(y,_={})=>(N(y,f.taintedFormState,_.taint??!0),m(y),d.set(Y(y))),update:(y,_={})=>d.update(F=>{const K=y(F);return N(K,f.taintedFormState,_.taint??!0),m(K),K})}}const T=[c.subscribe(a=>n=a)];function S(a){T.push(a)}function O(){T.forEach(a=>a())}const E=h(r.data);function M(a,d){if(!(!d||typeof d!="object")){if(Array.isArray(d))d.length>0&&M(a,d[0]);else if(!(d instanceof Date))throw new L(`Object found in form field "${a}". Set the dataType option to "json" and add use:enhance to use nested data structures. More information: https://superforms.rocks/concepts/nested-data`)}}async function H(a,d){a.valid&&d&&t.resetForm&&(t.resetForm===!0||t.resetForm())?C(a.message):ae(a,d),W.onUpdated.length&&await je();for(const y of W.onUpdated)y({form:a})}function C(a,d,y){const _=Y(i);_.data={..._.data,...d},y!==void 0&&(_.id=y),ae(_,!0,a)}const J=async(a,d)=>{if(a.type=="error")throw new L(`ActionResult of type "${a.type}" cannot be passed to update function.`);if(a.type=="redirect"){t.resetForm&&(t.resetForm===!0||t.resetForm())&&C();return}if(typeof a.data!="object")throw new L("Non-object validation data returned from ActionResult.");const y=l(a.data);if(!y.length)throw new L("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const _ of y)_.id===n&&await H(_,d??(a.status>=200&&a.status<300))},A=Z([]),P=Z(r.message),k=Z(r.constraints),I=Z(!1),x={subscribe:u.subscribe,set:u.set,update:u.update,clear:()=>Ee(u,{undefinePath:null,clearFormLevelErrors:!0})},$=Z();function ne(){return g($)}function U(a){if(a===null)throw new L("$tainted store contained null");if(typeof a=="object"){for(const d of Object.values(a))if(U(d))return!0}return a===!0}async function w(a,d){let y=t.validationMethod==="oninput";if(!y){const _=g(x),F=_?rt(_,a,{modifier:le=>{if(we(a,le))throw new L("Errors can only be added to form fields, not to arrays or objects in the schema. Path: "+le.path.slice(0,-1));return le.value}}):void 0;y=!!(F&&F.key in F.parent)}return y?(await he(a,t,E,x,$,{taint:d}),!0):!1}async function N(a,d,y){if(y===!1)return;if(y==="untaint-all"){$.set(void 0);return}let _=it(a,d);if(typeof y=="object"&&(typeof y.fields=="string"&&(y.fields=[y.fields]),_=y.fields.map(F=>oe(F)),y=!0),y===!0&&A.set(_),_.length&&($.update(F=>(F||(F={}),G(F,_,y===!0?!0:void 0),F)),!(t.validationMethod=="onblur"||t.validationMethod=="submit-only"))){let F=!1;for(const K of _)F=F||await w(K,y);F||await ft(t,g(E),x,g($))}}function q(a,d){$.set(a),m(d)}const j=Z(!1),D=Z(!1),z=Z(!1),ce=ee(x,a=>a?ot(a):[]);if(t.taintedMessage=void 0,ve(()=>{var a;O();for(const d of Object.values(W))d.length=0;(a=ie.get(s))==null||a.delete(o)}),t.dataType!=="json")for(const[a,d]of Object.entries(r.data))M(a,d);function ae(a,d,y){if(d&&q(typeof d=="boolean"?void 0:d,a.data),y=y??a.message,E.set(a.data,{taint:!1}),P.set(y),x.set(a.errors),c.set(a.id),I.set(a.posted),t.flashMessage&&_e(t)){const _=t.flashMessage.module.getFlash(re);y&&g(_)===void 0&&_.set(y)}}const W={onSubmit:t.onSubmit?[t.onSubmit]:[],onResult:t.onResult?[t.onResult]:[],onUpdate:t.onUpdate?[t.onUpdate]:[],onUpdated:t.onUpdated?[t.onUpdated]:[],onError:t.onError?[t.onError]:[]};Ne(a=>{if(t.taintedMessage&&!g(j)){const d=ne();d&&U(d)&&!window.confirm(t.taintedMessage)&&a.cancel()}}),S(re.subscribe(async a=>{if(!t.applyAction)return;t.SPA&&await new Promise(y=>setTimeout(y,0));const d=a.status>=200&&a.status<300;if(a.form&&typeof a.form=="object"){const y=a.form;if(y.type=="error")return;const _=l(y);for(const F of _)F.id!==n||X.has(F)||(X.set(F,F),await H(F,d))}else if(a.data&&typeof a.data=="object"){const y=l(a.data);for(const _ of y)_.id!==n||X.has(_)||ae(_,d)}}));const De=Object.fromEntries(Object.keys(i.data).map(a=>[a,{name:a,value:ye(E,a),errors:ye(x,a),constraints:ye(k,a)}]));function He(a,d){return a===void 0?$e(t,g(E),n,g(k),!1):he(oe(a),t,E,x,$,d)}return{form:E,formId:c,errors:x,message:P,constraints:k,fields:De,tainted:$,submitting:ee(j,a=>a),delayed:ee(D,a=>a),timeout:ee(z,a=>a),options:t,capture:function(){return{valid:i.valid,posted:g(I),errors:g(x),data:g(E),constraints:g(k),message:g(P),id:n,tainted:g($)}},restore:function(a){return ae(a,a.tainted??!0)},validate:He,enhance:(a,d)=>{if(d){if(d.onError){if(t.onError==="apply")throw new L('options.onError is set to "apply", cannot add any onError events.');if(d.onError==="apply")throw new L('Cannot add "apply" as onError event in use:enhance.');W.onError.push(d.onError)}d.onResult&&W.onResult.push(d.onResult),d.onSubmit&&W.onSubmit.push(d.onSubmit),d.onUpdate&&W.onUpdate.push(d.onUpdate),d.onUpdated&&W.onUpdated.push(d.onUpdated)}return pt(a,j,D,z,x,J,t,E,P,p,W,c,k,$,A,l,I)},allErrors:ce,posted:I,reset:a=>C(a!=null&&a.keepMessage?g(P):void 0,a==null?void 0:a.data,a==null?void 0:a.id)}}export{tt as e,Tt as s};
